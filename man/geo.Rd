% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/geo.R
\name{geo}
\alias{geo}
\title{Retrieve GEO Objects from NCBI GEO}
\usage{
geo(
  ids,
  amount = NULL,
  gse_matrix = TRUE,
  pdata_from_soft = TRUE,
  add_gpl = NULL,
  ftp_over_https = TRUE,
  handle_opts = list(),
  odir = getwd()
)
}
\arguments{
\item{ids}{Character vector of GEO accession IDs to download and parse.
All IDs must belong to the same GEO entity type. Examples:
\itemize{
\item DataSets: \code{c("GDS505", "GDS606")}
\item Series: \code{c("GSE2", "GSE22")}
}}

\item{amount}{A character string specifying the amount of data to retrieve.
One of \code{"brief"}, \code{"quick"}, \code{"data"}, \code{"full"}, \code{"soft"}, or
\code{"soft_full"}:
\itemize{
\item \code{"brief"}: shows only the accession's attributes.
\item \code{"quick"}: shows the accession's attributes and the first 20 rows of
its data table.
\item \code{"full"}: shows the accession's attributes and the complete data table.
This is the default when \code{ids} are not \code{DataSets} or \code{Series}.
\item \code{"data"}: omits the accession's attributes, showing only links to other
accessions and the full data table.
\item \code{"soft"}: SOFT (Simple Omnibus in Text Format) from GEO FTP site. When
\code{ids} is \code{DataSets} or \code{Series}, this is the default.
\item \code{"soft_full"}: full SOFT (Simple Omnibus in Text Format) files from GEO
FTP site by DataSet (GDS) containging additionally contains up-to-date
gene annotation for the DataSet Platform.
}

For \code{DataSet}, \code{"data"} and \code{"full"} will be mapped to \code{"soft"} and
\code{"soft_full"} respectively.}

\item{gse_matrix}{Logical, whether to retrieve Series Matrix files for
\code{GSE} entities. If \code{TRUE}, an \code{\link[Biobase:class.ExpressionSet]{ExpressionSet}} is
returned.}

\item{pdata_from_soft}{Logical, whether to derive \code{phenoData} from the GSE
series SOFT file when creating an
\code{\link[Biobase:class.ExpressionSet]{ExpressionSet}}.  Defaults to \code{TRUE}. If \code{FALSE},
\code{phenoData} is parsed from the series matrix file; note that some
\verb{characteristics_ch*} columns may not parse correctly.}

\item{add_gpl}{Logical or \code{NULL}. Whether to include platform information
(the \code{\link[Biobase:featureData]{featureData}} slot) when handling \code{GSE}
entities with \code{gse_matrix = TRUE}. If \code{NULL} (default), the function
attempts to map the GPL accession to a Bioconductor annotation package. If
successful, the \code{\link[Biobase:class.eSet]{annotation}} slot is updated and \code{add_gpl}
is set to \code{FALSE}; otherwise, \code{add_gpl} is set to \code{TRUE}.}

\item{ftp_over_https}{Logical scalar. If \code{TRUE}, connects to GEO FTP via
HTTPS (\verb{https://ftp.ncbi.nlm.nih.gov/geo}); otherwise, uses plain FTP.}

\item{handle_opts}{A list of named options / headers to be set in the
\code{\link[curl:multi_download]{multi_download}}.}

\item{odir}{Destination directory for downloads. Defaults to the current
working directory.}
}
\value{
Returns an object corresponding to the GEO entity type:
\itemize{
\item \code{GSE} with \code{gse_matrix = FALSE}: \linkS4class{GEOSeries} object.
\item \code{GSE} with \code{gse_matrix = TRUE}: an
\code{\link[Biobase:class.ExpressionSet]{ExpressionSet}} or a list of \code{ExpressionSet}s,
one per Series Matrix file.
\item Other entities: \linkS4class{GEOSoft} object.
}
}
\description{
This is the main user-facing function in the geokit package. It
downloads and parses GEO files, returning objects corresponding to different
GEO entity types.

\code{geo()} allows programmatic access to
\href{http://www.ncbi.nlm.nih.gov/geo}{NCBI GEO} data. GEO stores high-throughput
experimental data, including microarrays, SAGE, and mass spectrometry
proteomics. Entities handled by \code{geo()} include:
\itemize{
\item \strong{Platform (GPLxxx)}: Defines probe elements or detectable molecules.
\item \strong{Sample (GSMxxx)}: Describes conditions and measurements for individual
samples.
\item \strong{Series (GSExxx)}: Groups related samples, describing experimental
context.
\item \strong{DataSet (GDSxxx)}: Curated sets of comparable samples.
}

The function downloads and parses the relevant SOFT or Series Matrix files,
optionally mapping platform IDs to Bioconductor annotation packages.
}
\details{
The Gene Expression Omnibus (GEO) from NCBI serves as a public repository
for a wide range of high-throughput experimental data. These data include
single and dual channel microarray-based experiments measuring mRNA, genomic
DNA, and protein abundance, as well as non-array techniques such as serial
analysis of gene expression (SAGE), and mass spectrometry proteomic data. At
the most basic level of organization of GEO, there are three entity types
that may be supplied by users: Platforms, Samples, and Series.
Additionally, there is a curated entity called a GEO dataset.

A Platform record describes the list of elements on the array (e.g., cDNAs,
oligonucleotide probesets, ORFs, antibodies) or the list of elements that
may be detected and quantified in that experiment (e.g., SAGE tags,
peptides). Each Platform record is assigned a unique and stable GEO
accession number (GPLxxx). A Platform may reference many Samples that have
been submitted by multiple submitters.

A Sample record describes the conditions under which an individual Sample
was handled, the manipulations it underwent, and the abundance measurement
of each element derived from it. Each Sample record is assigned a unique and
stable GEO accession number (GSMxxx). A Sample entity must reference only
one Platform and may be included in multiple Series.

A Series record defines a set of related Samples considered to be part of a
group, how the Samples are related, and if and how they are ordered. A
Series provides a focal point and description of the experiment as a whole.
Series records may also contain tables describing extracted data, summary
conclusions, or analyses. Each Series record is assigned a unique and stable
GEO accession number (GSExxx).

GEO DataSets (GDSxxx) are curated sets of GEO Sample data. A GDS record
represents a collection of biologically and statistically comparable GEO
Samples and forms the basis of GEO's suite of data display and analysis
tools. Samples within a GDS refer to the same Platform, that is, they share
a common set of probe elements. Value measurements for each Sample within a
GDS are assumed to be calculated in an equivalent manner, that is,
considerations such as background processing and normalization are
consistent across the dataset. Information reflecting experimental design is
provided through GDS subsets.
}
\examples{
gse <- geo("GSE10", gse_matrix = FALSE, odir = tempdir())
gpl <- geo("gpl98", odir = tempdir())
gsm <- geo("GSM1", odir = tempdir())
gds <- geo("GDS10", odir = tempdir())
if (require("Biobase")) {
    gse_matix <- geo("GSE10", odir = tempdir())
}

}
\references{
\itemize{
\item \url{https://www.ncbi.nlm.nih.gov/geo/info/download.html}
\item \url{https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi}
\item \url{https://www.ncbi.nlm.nih.gov/geo/info/soft.html#format}
\item \href{https://ftp.ncbi.nlm.nih.gov/geo/README.txt}{Programmatic access to GEO FTP site}
}
}
